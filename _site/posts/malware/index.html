<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" 
  
>
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Malware Analysis" />
<meta name="author" content="Yuval Sandoval" />
<meta property="og:locale" content="en" />
<meta name="description" content="CVE-2017-11882 - Getting Our Hands Dirty With Some Malware." />
<meta property="og:description" content="CVE-2017-11882 - Getting Our Hands Dirty With Some Malware." />
<link rel="canonical" href="https://b1lib0by.github.io/posts/malware/" />
<meta property="og:url" content="https://b1lib0by.github.io/posts/malware/" />
<meta property="og:site_name" content="Yuval Sandoval" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-07-17T06:52:00+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Malware Analysis" />
<meta name="twitter:site" content="@YuvalBili" />
<meta name="twitter:creator" content="@YuvalBili" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yuval Sandoval","url":"https://github.com/B1LIB0BY/"},"dateModified":"2023-07-17T06:52:00+03:00","datePublished":"2023-07-17T06:52:00+03:00","description":"CVE-2017-11882 - Getting Our Hands Dirty With Some Malware.","headline":"Malware Analysis","mainEntityOfPage":{"@type":"WebPage","@id":"https://b1lib0by.github.io/posts/malware/"},"url":"https://b1lib0by.github.io/posts/malware/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Malware Analysis | Yuval Sandoval
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Yuval Sandoval">
<meta name="application-name" content="Yuval Sandoval">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="http://127.0.0.1:4000/assets/img/favicons/lol.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <div class="site-title">
      <a href="/">Yuval Sandoval</a>
    </div>
    <div class="site-subtitle fst-italic">16 Years old, Cyber Security Enthusaist And Linux EnjoyerüôÇ</div>
  </div>
  <!-- .profile-wrapper -->

  <ul class="nav flex-column flex-grow-1 w-100 ps-0">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
      <li class="nav-item">
        <a href="/categories/" class="nav-link">
          <i class="fa-fw fas fa-stream"></i>
          

          <span>CATEGORIES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/tags/" class="nav-link">
          <i class="fa-fw fas fa-tags"></i>
          

          <span>TAGS</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/archives/" class="nav-link">
          <i class="fa-fw fas fa-archive"></i>
          

          <span>ARCHIVES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/about/" class="nav-link">
          <i class="fa-fw "></i>
          

          <span>ABOUT</span>
        </a>
      </li>
      <!-- .nav-item -->
    
  </ul>
  <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/B1LIB0BY"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/YuvalBili"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['yuvalsan12345','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</div>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container px-xxl-5">
        <!-- The Top Bar -->

<div id="topbar-wrapper">
  <div
    id="topbar"
    class="container d-flex align-items-center justify-content-between h-100"
  >
    <span id="breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>Malware Analysis</span>
            

          
        
      
    </span>
    <!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </span>
    <span id="search-cancel">Cancel</span>
  </div>
</div>

        











<div class="row">
  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4">
    

    <div class="post px-1 px-md-2">
      

      
        
      
        <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->



  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  




<!-- return -->




<h1 data-toc-skip>Malware Analysis</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class=""
  data-ts="1689565920"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 17, 2023
</em>

    </span>

    <!-- lastmod date -->
    

  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        
          <a href="https://github.com/B1LIB0BY/">Yuval Sandoval</a>
          
        
      
      </em>
    </span>

    <div>
      <!-- read time -->
      <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1627 words"
>
  <em>9 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <h1 id="cve-2017-11882---getting-our-hands-dirty-with-some-malware">CVE-2017-11882 - Getting Our Hands Dirty With Some Malware.</h1>

<h2 id="intro"><span class="me-2">Intro</span><a href="#intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I have always liked to research things and understand the small details, When I was 12 my brother showed me the world of programming and from there I continued to the Cyber Security world and in particular, Investigate Malware and CTF‚Äôs.
Today we will investigate and try to understand a little more on what exactly is happening in CVE-2017-11882 while we will investigate an RTF file that contains the FormBook Malware.</p>

<h2 id="formbook"><span class="me-2">FormBook</span><a href="#formbook" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>FormBook is an infostealer malware discovered in 2016. It steals various data, including cached credentials, screenshots, and keystrokes. Additionally, it acts as a downloader for other malicious files. FormBook operates under a Malware as a Service (MaaS) model, available to cybercriminals at a low cost.</p>

<h2 id="analysis"><span class="me-2">Analysis</span><a href="#analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>On July 12, I received this email:
<a href="http://127.0.0.1:4000/assets/img/2023-07-17/Email1.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/Email1.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>With the Attachment ‚ÄúRFQ-PO802302535.doc‚Äù (Can be Downloaded from https://bazaar.abuse.ch/sample/43288168a2a440b39de9d1abad631654c7bd5f3e5cb2c1baeb93f28dce6b3eb2/)</p>

<h3 id="file-type"><span class="me-2">File Type</span><a href="#file-type" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>First when we Download the file, Its seems like we are dealing with a doc file (Microsoft Word file)</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/File_Type.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/File_Type.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>but when we check the file type we can see its RTF file which should give us a bad feeling about this file.</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/Real_File_Type.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/Real_File_Type.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>And after running strings on the file we can see more clearly that this is <strong>NOT</strong> an Microsoft Word File.</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/Strings.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/Strings.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<h3 id="what-is-rtf-file"><span class="me-2">What is RTF file?</span><a href="#what-is-rtf-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>RTF was created by the Microsoft Word team back in the 1980s. It was intended as a universal format that could be used by most word processors, making it easier for people to share Word documents with people who don‚Äôt use Word.</p>

<p>There are a few APT groups that used this Innocent looking file for malicious activities like <a href="https://attack.mitre.org/groups/G0065/">Leviathan</a> (APT 40) back in 2021 or <a href="https://know.netenrich.com/threatintel/threat_actor/APT-C-35%20DoNot%20Team">DoNot</a> Team (APT-C-35) back in 2021.</p>

<h3 id="rtf-tools"><span class="me-2">RTF Tools</span><a href="#rtf-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The Next step is to check out the streams on this file which we can do with <a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/rtfdump.py"><strong>rtfdump.py</strong></a> Written by DidierStevens.</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/rtf-tools1.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/rtf-tools1.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>We can see that we 3 streams following the name ‚ÄúEQUaTion.3‚Äù, and After looking closely we can see that all of them have the same MD5 which indicate us that those three are the same.</p>

<p>To Extract the stream we have two options.</p>

<h4 id="option-1"><span class="me-2">Option 1</span><a href="#option-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>We can use this tool and extract stream 1 using the command ( -s for stream and -H for Hex display ),
Which afterwards we gonna pipe the output into xxd that will filter the hexdump into just the raw bytes(Ascii)
And them write the output into a file called ‚Äústage2.txt‚Äù.</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>remnux@remnux:~/Desktop/Malware_Samples/Doc<span class="nv">$ </span>rtfdump.py <span class="nt">-s</span> 1 <span class="nt">-H</span> RFQ-PO802302535.doc

00000000: 9D A6 96 38 02 00 00 00  0B 00 00 00 45 51 55 61  ...8........EQUa
00000010: 54 69 6F 6E 2E 33 00 00  00 00 00 00 00 00 00 85  Tion.3..........
00000020: 07 00 00 02 7E 4E EB 47  78 01 05 FF 42 A6 EC 2C  ....~N.Gx...B..,
00000030: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000040: 00 00 00 00 00 00 00 00  50 06 45 00 00 00 00 00  ........P.E.....
00000050: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000060: 00 00 00 00 00 00 00 00  29 C3 44 00 00 00 00 E9  ........<span class="o">)</span>.D.....
00000070: FE 01 00 00 BE 27 65 FE  4A 01 FB 23 97 4A 7A 97  .....<span class="s1">'e.J..#.Jz.
00000080: 1D A8 EC 70 48 27 73 C2  BB 79 80 E7 89 32 1D C1  ...pH'</span>s..y...2..
00000090: 7D 09 23 ED 52 1C 80 15  FE 2A 7C 22 E0 D8 EA 82  <span class="o">}</span>.#.R....<span class="k">*</span>|<span class="s2">"....
000000A0: 17 EF 76 67 AC 99 DF 08  E3 A6 3B E0 6F CE 2F EC  ..vg......;.o./.
000000B0: BD E6 36 EE 25 2A E1 AD  3C 7D 11 33 07 A1 3D 0E  ..6.%*..&lt;}.3..=.
000000C0: 3E 7F B5 91 8E 63 D1 11  D9 3E 4B 29 74 E2 66 F8  &gt;....c...&gt;K)t.f.
000000D0: 69 4B 3F 5F B4 D1 05 46  88 78 3A D4 8A 22 F7 BA  iK?_...F.x:.."</span>..
...

remnux@remnux:~/Desktop/Malware_Samples/Doc<span class="nv">$ </span>rtfdump.py <span class="nt">-s</span> 1 <span class="nt">-H</span> RFQ-PO802302535.doc | xxd <span class="nt">-r</span> <span class="nt">-p</span> <span class="o">&gt;</span> stage2.txt
remnux@remnux:~/Desktop/Malware_Samples/Doc<span class="nv">$ </span><span class="nb">cat </span>stage2.txt

Raw bytes...

remnux@remnux:~/Desktop/Malware_Samples/Doc<span class="nv">$ </span>

</pre></td></tr></tbody></table></code></div></div>
<h4 id="option-2"><span class="me-2">Option 2</span><a href="#option-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Option 2 we can just take a copy of the hexdump and paste it into <a href="https://gchq.github.io/CyberChef/">Cyberchef</a>, Add in the Recipe ‚Äú From Hex ‚Äú and then save the output to a file.</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/Cyberchef.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/Cyberchef.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>Nice, Now we have the stream and we can continue with our investigation.</p>

<h3 id="rtf-stream"><span class="me-2">RTF stream</span><a href="#rtf-stream" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>RTF Stream could be any of these things, and now we are going to check and search for them:</p>

<ul>
  <li>
    <p>Regular RTF Stream - An RTF stream refers to the content of an RTF file, which consists of encoded instructions and text that define the formatting and structure of the document.</p>
  </li>
  <li>
    <p>Malicious macros - RTF Streams can include embedded macros written in a scripting language such as Visual Basic for Applications (VBA) Whice can be used to execute malicious code.</p>
  </li>
  <li>
    <p>OLE Object - RTF files can contain embedded objects, such as OLE (Object Linking and Embedding) objects, that carry malware payloads.</p>
  </li>
  <li>
    <p>Encoded payloads or ShellCode - RTF files may include encoded or obfuscated payloads within the RTF stream itself. These payloads can be encoded using techniques such as Base64, hex encoding, or custom algorithms, making it harder to detect and analyze the malicious content.</p>
  </li>
</ul>

<p>Those of you who already looked on this kind of files, we can see already that stage2.txt looks like a ShellCode and not a ole object but We can still check for VBA and OLE object with a package written by Philippe Lagadec , <a href="https://github.com/decalage2/oletools">oletools</a>.</p>

<h3 id="extracting-the-shellcode"><span class="me-2">Extracting the ShellCode</span><a href="#extracting-the-shellcode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>After the basic checks, Now we know that we are dealing with a Obfuscated ShellCode.</p>

<p>So we can see that our shellcode is Obfuscated and we cannot understand nothing from it.</p>

<p>There are many methods that used to make it difficult for us to detect the Shellcode, Some of them are:</p>

<ul>
  <li>
    <p>XOR Encoding - This method involves XOR-ing the shellcode bytes with a chosen key to obfuscate the original byte values. To execute the shellcode, it needs to be XOR-ed again with the same key to restore the original byte values before execution.</p>
  </li>
  <li>
    <p>Polymorphism - In this technique, the shellcode is constantly changed or mutated, making it difficult to recognize by signature-based detection methods.</p>
  </li>
  <li>
    <p>Encoding with Non-Printable Characters - The shellcode is encoded using non-printable characters, which can evade detection by security tools looking for typical ASCII strings.</p>
  </li>
  <li>
    <p>Garbage Instructions - Irrelevant instructions or junk code are inserted within the shellcode, making it harder to analyze and identify the actual malicious code.</p>
  </li>
  <li>
    <p>Anti-Debugging Techniques - Obfuscation methods can include anti-debugging techniques that prevent dynamic analysis by debugger tools.</p>
  </li>
</ul>

<p>In this blog post i will not go deep into those methods but for those who wants to get deeper in this subject,</p>

<p>I highly recommend ‚ÄúThe Shellcoder‚Äôs Handbook‚Äù by Chris Anley, John Heasman, Felix Lindner and Gerardo Richarte,
Really Nice Book üôÇ.</p>

<p>Back to our malware, We can use some tools to help us Deobfuscate the Shellcode, first we will try to use Xor based solution, <a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/xorsearch.py">xorsearch.py</a> again by DidierStevens.</p>

<p>The primary function of xorsearch.py is to find the XOR key used to obfuscate shellcode. It does this by employing brute.
The tool takes a sample of the obfuscated shellcode and tests various XOR keys on it to check for potential XOR-encoded strings. When a significant number of printable characters are found in the decoded output, xorsearch.py assumes it has found the correct XOR key.</p>

<p>Lets cat out the potential Shellcode that we found (stage2.txt) and pipe the output into the python script tool with the -W flag which tell the program to search with embedded wildcards.</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>remnux@remnux:~/Desktop/Malware_Samples/Doc<span class="nv">$ </span><span class="nb">cat </span>stage2.txt | xorsearch <span class="nt">-W</span> -

Number of bytes <span class="nb">read </span>from stdin: 1968
Found XOR 00 position 0000039A: GetEIP method 3 E921FFFFFF
Found XOR 00 position 00000434: GetEIP method 3 E987FEFFFF
Found ROT 25 position 0000039A: GetEIP method 3 E921FFFFFF
Found ROT 25 position 00000434: GetEIP method 3 E987FEFFFF
Found ROT 01 position 0000039A: GetEIP method 3 E921FFFFFF
Found ROT 01 position 00000434: GetEIP method 3 E987FEFFFF
Score: 60

remnux@remnux:~/Desktop/Malware_Samples/Doc<span class="nv">$ </span>

</pre></td></tr></tbody></table></code></div></div>

<p>And we have a match! the program found a few potential Strings and its looking good.</p>

<p>To be sure and to Deobfuscate this shellcode we will start scdbg, scdbg is a shellcode analysis application. When run it will display to the user all of the Windows API the shellcode attempts to call.</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/scdbg.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/scdbg.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>Include the file (stage2.txt), mark the findSc (Find Shell Code), Scan for API Table, Report mode and Create Dump for later.</p>

<p>And Run‚Ä¶</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/scdbg_results.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/scdbg_results.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>The program found 8 possible options, just select one and‚Ä¶</p>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/scdbg_results2.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/scdbg_results2.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<p>We got a Shellcode!</p>

<p>We can see what this ‚ÄúDoc‚Äù file is doing And we‚Äôll wrap it up.</p>

<ul>
  <li>First we got a weird looking file, we found out that the file isn‚Äôt a doc file but rather a RTF file.</li>
  <li>We extracted the stream from the RTF file.</li>
  <li>We tried to figure out what is the method the author of this malware used to Obfuscate.</li>
  <li>We tried a few tools that helped us extract the shellcode.</li>
  <li>We Saw that the shellcode is actually Download another weird looking EXE file from a weird Domain.</li>
</ul>

<p>The Domain in the time of writing this blog is Down, Which means that people already reported about this malware.
As you can see the shellcode that we have found, is gonna download the Kt4sS99OJkneo.exe and run it, This file is another stage of the FormBook Malware whice we not gonna get into in this blog.</p>

<h3 id="virus-total-results"><span class="me-2">Virus Total Results</span><a href="#virus-total-results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="http://127.0.0.1:4000/assets/img/2023-07-17/VirusTotal.png" class="popup img-link normal"><img data-src="http://127.0.0.1:4000/assets/img/2023-07-17/VirusTotal.png" alt="Desktop View"  class="lazyload" data-proofer-ignore></a></p>

<h2 id="iocs"><span class="me-2">IOC‚Äôs</span><a href="#iocs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="urls"><span class="me-2">URL‚Äôs</span><a href="#urls" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>https[:]//www.torq.qa/fIPfypJYu76PrjPnEo[.]exe</li>
  <li>https[:]//www.torq.qa/Kt4sS99OJkneo[.]exe</li>
  <li>http[:]//www.torq.qa/Kt4sS99OJkneo[.]exe</li>
</ul>

<h3 id="sample-sha-256"><span class="me-2">Sample SHA-256</span><a href="#sample-sha-256" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>[RFQ-PO802302535.doc] - [43288168a2a440b39de9d1abad631654c7bd5f3e5cb2c1baeb93f28dce6b3eb2]</li>
  <li>[Kt4sS99OJkneo.exe] - [b884bd75ed004c71503776351d1bd64e1a03e106be6df6baed9f16c7239e0f01]</li>
</ul>

<h1 id="thank-for-reading">Thank For Reading.</h1>


</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw me-1"></i>
    
      <a href='/categories/blogging/'>Blogging</a>,
      <a href='/categories/malware/'>Malware</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw me-1"></i>
      
      <a href="/tags/typography/"
          class="post-tag no-text-decoration" >typography</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!-- Post sharing snippet -->

<div class="share-wrapper">
  <span class="share-label text-muted me-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=Malware%20Analysis%20-%20Yuval%20Sandoval&url=https%3A%2F%2Fb1lib0by.github.io%2Fposts%2Fmalware%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fab fa-twitter"></i>
      </a>
    
      
      <a
        href="https://www.facebook.com/sharer/sharer.php?title=Malware%20Analysis%20-%20Yuval%20Sandoval&u=https%3A%2F%2Fb1lib0by.github.io%2Fposts%2Fmalware%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=https%3A%2F%2Fb1lib0by.github.io%2Fposts%2Fmalware%2F&text=Malware%20Analysis%20-%20Yuval%20Sandoval"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <i
      id="copy-link"
      class="fa-fw fas fa-link small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
    </i>
  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
      
    </div>
  </div>
  <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
    <div class="access">
      <!-- Get the last 5 posts from lastmod list. -->















      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/typography/">typography</a>
      
    </div>
  </div>


    </div>

    
      
      



  <div id="toc-wrapper" class="ps-0 pe-4 mb-5">
    <div class="panel-heading ps-3 pt-2 mb-2">Contents</div>
    <nav id="toc"></nav>
  </div>


    
  </div>
</div>

<!-- tail -->

  <div class="row">
    <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5">
      
        
        <!--
  Recommend the other 3 posts according to the tags and categories of the current post,
  if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->








  

  
    





<!-- Fill with the other newlest posts -->



  
    
    
  




      
        
        <!-- Navigation buttons at the bottom of the post. -->

<div class="post-navigation d-flex justify-content-between">
  
    <div
      class="btn btn-outline-primary disabled"
      prompt="Older"
    >
      <p>-</p>
    </div>
  

  
    <div
      class="btn btn-outline-primary disabled"
      prompt="Newer"
    >
      <p>-</p>
    </div>
  
</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>


        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 post-content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/typography/">typography</a>
      
    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>
    </div>

    <!-- The Footer -->

<footer>
  <div class="container px-lg-4">
    <div class="d-flex justify-content-center align-items-center text-muted mx-md-3">
      <p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
      </p>

      <p>¬©
        2023
        <a href="https://twitter.com/YuvalBili">Yuval</a>.
        
          <span
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
          >Some rights reserved.</span>
        
      </p>
    </div>
  </div>
</footer>


    <div id="mask"></div>

    <button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow">
      <i class="fas fa-angle-up"></i>
    </button>

    
      <div
        id="notification"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-animation="true"
        data-bs-autohide="false"
      >
        <div class="toast-header">
          <button
            type="button"
            class="btn-close ms-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="px-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js,npm/mermaid@9.4.3/dist/mermaid.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
    /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
    MathJax = {
      tex: {
        /* start/end delimiter pairs for in-line math */
        inlineMath: [
          ['$', '$'],
          ['\\(', '\\)']
        ],
        /* start/end delimiter pairs for display math */
        displayMath: [
          ['$$', '$$'],
          ['\\[', '\\]']
        ]
      }
    };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>





    
      <!-- mermaid-js loader -->
<script type="text/javascript">
  (function () {
    function updateMermaid(event) {
      if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
        const mode = event.data.message;

        if (typeof mermaid === 'undefined') {
          return;
        }

        let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default';
        let config = { theme: expectedTheme };

        /* Re-render the SVG ‚Ä∫ <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $('.mermaid').each(function () {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr('data-processed');
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, '.mermaid');
      }
    }

    let initTheme = 'default';
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = 'dark';
    }

    let mermaidConf = {
      theme: initTheme /* <default|dark|forest|neutral> */
    };

    /* Create mermaid tag */
    document.querySelectorAll('pre>code.language-mermaid').forEach((elem) => {
      const svgCode = elem.textContent;
      const backup = elem.parentElement;
      backup.classList.add('unloaded');
      /* create mermaid node */
      let mermaid = document.createElement('pre');
      mermaid.classList.add('mermaid');
      const text = document.createTextNode(svgCode);
      mermaid.appendChild(text);
      backup.after(mermaid);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener('message', updateMermaid);
  })();
</script>

    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

